<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>PPD - Exercici 2</title>
</head>
<body>
<div class="lateral_bar">
	<ul>
	<li><a href="#tasca21">Tasca 2.1</a></li>
	<li><a href="#tasca22">Tasca 2.2</a></li>
	<li><a href="#tasca23">Tasca 2.3</a></li>
	<li><a href="#tasca24">Tasca 2.4</a></li>
	<li><a href="#tasca25">Tasca 2.5</a></li>
	<li><a href="#tasca26">Tasca 2.6</a></li>
	</ul>

</div>
<div class="main">
    	<h1><br>EXERCICI 2 -PRÁCTICA PPD UOC MAIG 2024</h1>
    	
    	<p id="inici"> </p>
        <h2 id="tasca21">Tasca 2.1</h2>
	<p><i>Genera un clip de vídeo de qualitat HD d’uns 20 segons de durada (o descarrega’l de la web) que
	posseeixi moviment (quelcom equivalent al clip de futbol que he usat d’exemple).
	Sigui qui sigui el seu format, converteix-lo a MP4 amb Avidemux amb els següents valors i l’anomenarem
	clip01. La codificació de sortida serà MPEG4 AVC i a VIDEO OUTPUT-CONFIGURACIÓ selecciona com a
	mode de codificació TASA DE BITS MEDIA-DOS PASADAS (per mantenir la qualitat) i 5000 Kbps. Com	
	format d’àudio, MP3 (lame) i com a contenidor, MKV. Inclou aquests clips en el lliurament de la pràctica.
	Confirma amb MediaInfo que Avidemux ha realitzat la feina correctament.</i></p>

	<p>A continuació es presenta el video demanat anomenat clip01 codificat i configurat segons les característiques demanades a la 		tasca.</p>
	
	        <p><video src="videos/clip01.mkv" type='video/mp4; codecs="theora, vorbis"' autoplay controls width="640" height="360"></video></p>
	<p>Si la reproducció falla per falta de compatibilitat mkv amb el navegador pots baixar l'arxiu mkv <a href="videos/clip01.zip">aquí</a>.</p>
	
	<p><br></p>	
	<p>I a la següent figura (figura 3.) es mostra a captura del mediainfo del arxiu. El valors que es mostren a la figura 		 	coincideixen amb els demanats a la pràctica: 5000 kbps, audio mp3, contenidor Matroska, video AVC</p>

	<img src="img/21fig3.png" />
        <p> Figura 3.</p>
        
	<h2 id="tasca22">Tasca 2.2</h2>
	
	<p><i>Configura una emissió repetitiva i una recepció del clip01 amb els mateixos valors emprats al clip
de futbol. Al VLC d'emissió, menú EINES-INFORMACIÓ DEL CÓDEC-CÓDEC (a Mac: FINESTRA-
INFORMACIÓ MULTIMÈDIA-DETALLS DEL CÓDEC), indica els còdecs amb els quals diu que es va
generar el fitxer emmagatzemat. A ESTADÍSTIQUES indica la TAXA DE BITS DE CONTINGUT que
està llegint de disc, és la necessària per a una reproducció correcta del contingut (és un valor canviant, de
manera que pren un valor mitjà aproximat).</i></p>
	
	<p>Segons es desprén de la informació donada per VLC i mostrada en captura de pantalla a la figura 4 els còdecs amb els que es va generar el fitxer emmagatzemat van ser H.264 AVD (part 10).</p>
	<img src="img/22infcodec.png" />
        <p> Figura 4.</p>
        
        <p>La taxa de bits de contingut al moment de la captura es de  4792kps. S'ha intentat agafar un valor mitja donat que el valor va canviat especialment al principi i al final del video. Com es va indicar a la tasca 2.1 el vìdeo es va generar amb un kbps de 5000. Es lògic esperar doncs que la taxa de bits rondi aquest valor. En efecte seria la necesaria per una correcta reproducció del vìdeo. La baixada d'aquest valor per sota dels 5000 kbps de mitajan fa que es talli el vìdeo com pasa al final del loop de reproducció.</p>
	<img src="img/22tasa.png" />
        <p> Figura 5.</p>
	
	
	<h2 id="tasca23">Tasca 2.3</h2>
	
	<p><i>al VLC de recepció, mitjançant EINES-INFORMACION DEL CODEC-CÓDEC (a Mac:
FINESTRA-INFORMACIÓ MULTIMÈDIA-DETALLS DEL CÓDEC) confirma que el stream està codificat
en els formats de vídeo i àudio seleccionats. A ESTADÍSTIQUES indica la TAXA DE BITS DE
CONTINGUT a la qual està arribant el stream (pren un valor mitjà aproximat).</i></p>
	
	<p>Segons es desprén de la informació donada per VLC i mostrada en captura de pantalla a la figura 6 els còdecs
	del fitxer rebut van ser H.264 AVD (part 10).</p>
	<img src="img/23infcodec.png" />
        <p> Figura 6.</p>
        
        <p>La taxa de bits de contingut al moment de la captura es de  1613kps. Es un valor que només s'actulitza al inici del loop de reproducció.</p>
        <img src="img/23tasa.png" />
        <p> Figura 7.</p>
	
	
	<h2 id="tasca24">Tasca 2.4</h2>
	
	<p><i>si realitzes una pausa en el VLC emissor, quants segons triga en pausar-se el vídeo al receptor?
Per què? Torna-ho a posar en reproducció.</i></p>
	
	<p>La quantitat de temps aproximat que triga en aturar-se o possar-se en marxa es d'una 2-3 segons. La quantitat de temps que trigarà el vídeo a aturar-se al client després de posar en pausa l'emissió al servidor depèn de diversos factors com poden ser:
	<ol>
    	<li><strong>Memòria intermèdia (buffer):</strong> El client (receptor) tindrà una certa quantitat de dades emmagatzemades en memòria intermèdia abans que es reprodueixin. Aquestes dades emmagatzemades són una mena de "coixí" per assegurar una reproducció fluida, fins i tot si hi ha petites interrupcions en la transmissió de dades.</li>

    	<li><strong>Taxa de bits (bitrate):</strong> La taxa de bits del vídeo és de 5000 kbps a l'emissió i .</li>

    	<li><strong>Capacitat de la memòria intermèdia:</strong> La memòria intermèdia del client es mesura en termes de temps de reproducció que pot contenir, que sovint es pot ajustar a les opcions del VLC. Suposem, per exemple, que la memòria intermèdia està configurada per contenir 10 segons de dades de vídeo.</li>
    	</ol>

<p>Per fer un càlcul aproximat i afengint la dada que el clip01 ocupa un espai en disc de 12Mb onsiderem que la memòria interna del buffer es tot el video (que es reprodueix en bucle). Sabent aquestes dades tindriem que el video donada la taxa de reproducció es podría reproduir 12 Mb/5000kbps = 2,4 segons. Si asumim que aquesta es la capacitat de memoria intermitja (que no s'ha definit en cap opció de VLC) els valors encaixen força bé amb la resposta que obtenim del sistema.</p>
	<h2 id="tasca25">Tasca 2.5</h2>
	
	<p><i>Calcula aproximadament la compressió que el VLC d'emissió està realitzant al transcodificar el
fitxer emmagatzemat a stream. Realitza una captura de pantalla de l'escriptori amb els dos VLC en marxa i les
seves finestres amb les estadístiques de cadascun obertes, i insereix la captura en el document en el qual
escrius les respostes d'aquesta pràctica.</i></p>
	
	<p>A continuació es mostra la imatge demanada en la figura 8. A la esquerra es pot trobar la finestra d'estadística de la emissió mentre que a la dreta es trova la de recepció. La tasa de bits de contingut de l'emissió es força inestable i tot i que podem veure el valor 4992 kb/s realmente els valor que es poden veure oscil·len entre 3000 i 6000 kb/s realmente. Es esperable que la mitjana estigui força a prop de 5000 kb/s que es la taxa a la que hem definit el vídeo clp01 a la tasca 2.1. La recepció si que es força estable i es troba entorno als 1550 kbps. Fent la divissió dels dos valors podríem dir que la compressió que está realitzant el VLC es d'un factor 3,2 al reailtzar el stream.<br></p>
	
        <img src="img/25est.png" />
        <p> Figura 8.</p>
	
	
	<h2 id="tasca26">Tasca 2.6</h2>
	
	<p><i>Enfocant-nos en la transmissió en viu d’un stream de vídeo mitjançant un servei de cloud CDN,
aquests ofereixen múltiples modes de distribució, com per exemple streaming de baixa latència per entorns
de mínim retard, streaming per OTT, etc... fins i tot interactiu!. De les múltiples opcions que pots trobar, centra’t en una i descriu el procés (màxim tres pàgines). Si en el procés s’apliquen polítiques específiques d’usuaris o recursos, roles de gestió i administració de serveis, indica-ho. I opcionalment i si l’entorn t’ho permet, fes un càlcul estimatiu de cost per minut d’una transmissió dins
una mateixa regió d’un stream HD en directe per 10.000 usuaris simultanis.</i></p>

    <h4>Transmissió en viu d'un stream de vídeo mitjançant un servei de cloud CDN amb baixa latència</h4>

    <h4>Introducció</h4>
    <p>La transmissió en viu amb baixa latència és crucial per a aplicacions on el retard ha de ser mínim, com en esdeveniments esportius, notícies en directe, jocs en línia i altres esdeveniments interactius. Els serveis de CDN en el núvol ofereixen solucions específiques per minimitzar la latència i proporcionar una experiència de visualització fluida. En aquesta descripció ens centrarem en el procés de transmissió de vídeo en viu de baixa latència utilitzant Amazon Web Services (AWS) com a exemple, utilizat en les PACs anteriors.
    </p>

    <h4>Procés de Transmissió en Viu amb Baixa Latència</h4>
    
    <h5>1. Configuració de l'Infraestructura de Transmissió</h5>
    <ol>
        <li><strong>Càmara i Codificador:</strong>
            <ul>
                <li>El flux de vídeo en viu es captura utilitzant una càmera de vídeo.</li>
                <li>El vídeo capturat es passa a través d'un codificador que converteix el senyal de vídeo a un format digital adequat per a la transmissió (per exemple, H.264 per al vídeo i AAC per a l'àudio).</li>
            </ul>
        </li>
        <li><strong>Transmissió al Punt d'Entrada:</strong>
            <ul>
                <li>El codificador envia el flux de vídeo a un punt d'entrada de la xarxa utilitzant protocols com RTMP (Real-Time Messaging Protocol).</li>
            </ul>
        </li>
    </ol>

    <h5>2. Distribució a través del Servei de Cloud CDN</h5>
    <ol>
        <li><strong>Ingestió a AWS Elemental MediaLive:</strong>
            <ul>
                <li>AWS Elemental MediaLive rep el flux de vídeo en viu del codificador.</li>
                <li>MediaLive processa el flux de vídeo, aplicant transcodificació en temps real per generar múltiples variants adaptatives (diferents resolucions i bitrates).</li>
            </ul>
        </li>
        <li><strong>AWS Elemental MediaPackage:</strong>
            <ul>
                <li>Les variants transcodificades es passen a AWS Elemental MediaPackage.</li>
                <li>MediaPackage crea paquets de vídeo que es poden distribuir en formats de transmissió com HLS (HTTP Live Streaming) i DASH (Dynamic Adaptive Streaming over HTTP).</li>
                <li>S'activen les opcions de baixa latència, com l'HLS de baixa latència (LL-HLS).</li>
            </ul>
        </li>
        <li><strong>Distribució amb Amazon CloudFront:</strong>
            <ul>
                <li>Amazon CloudFront, el CDN de AWS, distribueix els paquets de vídeo als espectadors de manera global.</li>
                <li>CloudFront té punts de presència (PoP) a tot el món que emmagatzemen a la memòria cau i lliuren el contingut amb baixa latència.</li>
            </ul>
        </li>
    </ol>

    <h5>3. Reproducció per part dels Usuaris Finals</h5>
    <ol>
        <li><strong>Accés al Flux de Vídeo:</strong>
            <ul>
                <li>Els usuaris finals accedeixen al flux de vídeo en viu a través d'una aplicació o lloc web.</li>
                <li>El reproductor de vídeo de l'aplicació fa peticions als servidors de CloudFront per obtenir els segments de vídeo.</li>
            </ul>
        </li>
        <li><strong>Reproducció de Baixa Latència:</strong>
            <ul>
                <li>El reproductor de vídeo descodifica i reprodueix els segments de vídeo amb un retard mínim, proporcionant una experiència de baixa latència als usuaris.</li>
            </ul>
        </li>
    </ol>

    <h4>Polítiques d'Usuaris i Recursos, Rols de Gestió</h4>
    <ul>
        <li><strong>Polítiques d'Usuaris:</strong>
            <ul>
                <li>Es poden establir polítiques de control d'accés per assegurar que només els usuaris autoritzats puguin accedir a la transmissió en viu.</li>
                <li>Mitjançant AWS IAM (Identity and Access Management), es pot controlar qui té permís per gestionar els serveis de transmissió.</li>
            </ul>
        </li>
        <li><strong>Rols de Gestió i Administració:</strong>
            <ul>
                <li>Administradors de Sistema: Configuren i mantenen la infraestructura de transmissió, gestionen les polítiques de seguretat i supervisen el rendiment.</li>
                <li>Operadors de Contingut: Gestionen els fluxos de vídeo en viu, incloent-hi la codificació i la ingesta de vídeo.</li>
                <li>Desenvolupadors: Integren el flux de vídeo a les aplicacions i llocs web, optimitzant el reproductor de vídeo per a la baixa latència.</li>
            </ul>
        </li>
    </ul>

    <h4>Càlcul Estimatiu de Cost</h4>
    <p>
        Per a una transmissió en viu en HD amb 10,000 usuaris simultanis dins d'una mateixa regió, es fa una estimació dels costos utilitzant les tarifes aproximades de AWS.
    </p>

    <ul>
        <li><strong>Ingress de Vídeo (MediaLive):</strong>
            <ul>
                <li>Suposem una taxa de $0.10 per minut per un canal en viu en HD.</li>
            </ul>
        </li>
        <li><strong>Embalatge (MediaPackage):</strong>
            <ul>
                <li>Suposem $0.025 per GB processat. Amb una taxa de bits de 5 Mbps per HD, això equival a 0.058 $ per hora per usuari.</li>
            </ul>
        </li>
        <li><strong>Distribució (CloudFront):</strong>
            <ul>
                <li>Suposem $0.085 per GB lliurat dins de la mateixa regió.</li>
            </ul>
        </li>
    </ul>

    <p>Càlcul del cost per minut:</p>
    <ol>
        <li><strong>Ingress de Vídeo:</strong>
            <p>0.10 $ × 1 min = 0.10 $/min</p>
        </li>
        <li><strong>Embalatge:</strong>
            <p>2.34 GB/hora × 0.025 $/GB = 0.058 $ per usuari</p>
            <p>0.058 $ × 10,000 usuaris = 58 $</p>
        </li>
        <li><strong>Distribució:</strong>
            <p>2.34 GB/hora × 0.085 $/GB = 0.1989 $ per usuari</p>
            <p>0.1989 $ × 10,000 usuaris = 1989 $</p>
        </li>
    </ol>

    <p><strong>Cost total per minut:</strong></p>
    <p>0.10 $ + 58/60min $ + 1989/60min $ = 34.21 $/min</p>

    <h4>Conclusions</h4>
    <p>
        La transmissió en viu amb baixa latència utilitzant un servei de cloud CDN com AWS implica diversos passos, des de la captura i codificació del vídeo fins a la distribució i reproducció pels usuaris finals. El procés inclou polítiques d'usuaris i gestió de recursos per garantir la seguretat i eficàcia de la transmissió. Els costos associats poden variar segons el servei utilitzat i els requisits específics, però una estimació proporciona una guia per planificar el pressupost de la transmissió en viu.
    </p>
</div>
    
</body>
</html>

